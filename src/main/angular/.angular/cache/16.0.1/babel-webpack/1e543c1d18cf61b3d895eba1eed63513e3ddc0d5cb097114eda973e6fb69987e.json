{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"@angular/forms\";\nfunction AppComponent_tr_15_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\")(2, \"button\", 5);\n    i0.ɵɵlistener(\"click\", function AppComponent_tr_15_Template_button_click_2_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r5);\n      const bucket_r3 = restoredCtx.$implicit;\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.deleteBucket(bucket_r3));\n    });\n    i0.ɵɵtext(3, \" X \");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"td\");\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"td\")(7, \"input\", 6);\n    i0.ɵɵlistener(\"change\", function AppComponent_tr_15_Template_input_change_7_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r5);\n      const bucket_r3 = restoredCtx.$implicit;\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.uploadFile($event, bucket_r3));\n    });\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const bucket_r3 = ctx.$implicit;\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(bucket_r3);\n  }\n}\nfunction AppComponent_option_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 7);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const bucket_r7 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", bucket_r7);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(bucket_r7);\n  }\n}\nfunction AppComponent_tr_32_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\")(8, \"span\", 8)(9, \"button\", 9);\n    i0.ɵɵlistener(\"click\", function AppComponent_tr_32_Template_button_click_9_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r10);\n      const file_r8 = restoredCtx.$implicit;\n      const ctx_r9 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r9.downloadFile(file_r8.name));\n    });\n    i0.ɵɵtext(10, \"Download\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtext(11, \" / \");\n    i0.ɵɵelementStart(12, \"button\", 10);\n    i0.ɵɵlistener(\"click\", function AppComponent_tr_32_Template_button_click_12_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r10);\n      const file_r8 = restoredCtx.$implicit;\n      const ctx_r11 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r11.deleteFile(file_r8.name));\n    });\n    i0.ɵɵtext(13, \"Delete\");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const file_r8 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(file_r8.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(file_r8.lastModified);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r2.formatSize(file_r8.size));\n  }\n}\nlet AppComponent = /*#__PURE__*/(() => {\n  class AppComponent {\n    constructor(http) {\n      this.http = http;\n      this.title = 'angular';\n      this.buckets = [];\n      this.bucketName = '';\n      this.files = [];\n      this.selectedBucket = '';\n      this.baseUrl = 'http://localhost:8080'; // Spring Boot 项目的 URL\n    }\n\n    ngOnInit() {\n      this.listBuckets();\n      this.getFiles();\n    }\n    formatSize(size) {\n      if (size < 1024) {\n        return size + ' B';\n      } else if (size < 1024 * 1024) {\n        return (size / 1024).toFixed(2) + ' KB';\n      } else if (size < 1024 * 1024 * 1024) {\n        return (size / 1024 / 1024).toFixed(2) + ' MB';\n      } else {\n        return (size / 1024 / 1024 / 1024).toFixed(2) + ' GB';\n      }\n    }\n    listBuckets() {\n      this.http.get('http://localhost:8080/listBuckets').subscribe(response => {\n        this.buckets = response.buckets;\n      });\n    }\n    createBucket() {\n      this.http.post(`http://localhost:8080/createBucket?bucketName=${this.bucketName}`, {}).subscribe(response => {\n        console.log(response);\n        this.listBuckets();\n      });\n    }\n    deleteBucket(bucketName) {\n      this.http.post(`http://localhost:8080/deleteBucket?bucketName=${bucketName}`, null).subscribe(response => {\n        if (response.message === '删除成功') {\n          this.buckets = this.buckets.filter(bucket => bucket !== bucketName);\n        } else {\n          alert(response.message);\n        }\n      });\n    }\n    uploadFile(event, bucketName) {\n      const file = event.target.files[0];\n      const formData = new FormData();\n      formData.append('file', file);\n      formData.append('bucketName', bucketName);\n      this.http.post(`${this.baseUrl}/upload`, formData).subscribe(response => {\n        console.log(response);\n        alert(response.message);\n        this.getFiles();\n      }, error => {\n        console.log(error);\n        alert(error.error.message);\n      });\n    }\n    getFiles() {\n      if (this.selectedBucket) {\n        this.http.get(`${this.baseUrl}/list?bucketName=${this.selectedBucket}`).subscribe(data => {\n          this.files = data;\n        }, error => {\n          console.log(error);\n        });\n      }\n    }\n    downloadFile(name) {\n      this.http.get(`${this.baseUrl}/download/${name}?bucketName=${this.selectedBucket}`, {\n        responseType: 'blob'\n      }).subscribe(data => {\n        const url = window.URL.createObjectURL(data);\n        const link = document.createElement('a');\n        link.href = url;\n        link.download = name;\n        link.click();\n      }, error => {\n        console.log(error);\n      });\n    }\n    deleteFile(name) {\n      this.http.delete(`${this.baseUrl}/delete/${name}?bucketName=${this.selectedBucket}`, {\n        responseType: 'text'\n      }).subscribe(data => {\n        console.log(data);\n        this.getFiles(); // 重新获取文件列表\n      }, error => {\n        console.log(error);\n      });\n    }\n  }\n  AppComponent.ɵfac = function AppComponent_Factory(t) {\n    return new (t || AppComponent)(i0.ɵɵdirectiveInject(i1.HttpClient));\n  };\n  AppComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AppComponent,\n    selectors: [[\"app-root\"]],\n    decls: 33,\n    vars: 5,\n    consts: [[\"type\", \"text\", \"placeholder\", \"Bucket name\", 3, \"ngModel\", \"ngModelChange\"], [3, \"click\"], [4, \"ngFor\", \"ngForOf\"], [3, \"ngModel\", \"ngModelChange\", \"change\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [1, \"delete-button\", 3, \"click\"], [\"type\", \"file\", 3, \"change\"], [3, \"value\"], [1, \"action-buttons\"], [1, \"download-button\", 3, \"click\"], [1, \"delete-button1\", 3, \"click\"]],\n    template: function AppComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"h2\");\n        i0.ɵɵtext(1, \"Buckets\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(2, \"ul\")(3, \"h3\")(4, \"input\", 0);\n        i0.ɵɵlistener(\"ngModelChange\", function AppComponent_Template_input_ngModelChange_4_listener($event) {\n          return ctx.bucketName = $event;\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(5, \"button\", 1);\n        i0.ɵɵlistener(\"click\", function AppComponent_Template_button_click_5_listener() {\n          return ctx.createBucket();\n        });\n        i0.ɵɵtext(6, \"Create\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(7, \"table\")(8, \"tr\")(9, \"th\");\n        i0.ɵɵtext(10, \"Delete\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(11, \"th\");\n        i0.ɵɵtext(12, \"Bucket\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"th\");\n        i0.ɵɵtext(14, \"Upload File\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(15, AppComponent_tr_15_Template, 8, 1, \"tr\", 2);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(16, \"h2\");\n        i0.ɵɵtext(17, \"Objects\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(18, \"h3\");\n        i0.ɵɵtext(19, \"Choose bucket:\\n\");\n        i0.ɵɵelementStart(20, \"select\", 3);\n        i0.ɵɵlistener(\"ngModelChange\", function AppComponent_Template_select_ngModelChange_20_listener($event) {\n          return ctx.selectedBucket = $event;\n        })(\"change\", function AppComponent_Template_select_change_20_listener() {\n          return ctx.getFiles();\n        });\n        i0.ɵɵtemplate(21, AppComponent_option_21_Template, 2, 2, \"option\", 4);\n        i0.ɵɵelementEnd()();\n        i0.ɵɵelementStart(22, \"table\")(23, \"tr\")(24, \"th\");\n        i0.ɵɵtext(25, \"Name\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(26, \"th\");\n        i0.ɵɵtext(27, \"Last Modified\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(28, \"th\");\n        i0.ɵɵtext(29, \"Size\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(30, \"th\");\n        i0.ɵɵtext(31, \"Actions\");\n        i0.ɵɵelementEnd()();\n        i0.ɵɵtemplate(32, AppComponent_tr_32_Template, 14, 3, \"tr\", 2);\n        i0.ɵɵelementEnd();\n      }\n      if (rf & 2) {\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngModel\", ctx.bucketName);\n        i0.ɵɵadvance(11);\n        i0.ɵɵproperty(\"ngForOf\", ctx.buckets);\n        i0.ɵɵadvance(5);\n        i0.ɵɵproperty(\"ngModel\", ctx.selectedBucket);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.buckets);\n        i0.ɵɵadvance(11);\n        i0.ɵɵproperty(\"ngForOf\", ctx.files);\n      }\n    },\n    dependencies: [i2.NgForOf, i3.NgSelectOption, i3.ɵNgSelectMultipleOption, i3.DefaultValueAccessor, i3.SelectControlValueAccessor, i3.NgControlStatus, i3.NgModel],\n    styles: [\"h2[_ngcontent-%COMP%]{background-color:gray;color:#fff;padding:14px 20px;text-align:center}h3[_ngcontent-%COMP%]{margin-left:50px}.delete-button[_ngcontent-%COMP%]{color:red}.action-buttons[_ngcontent-%COMP%]{border:none;background:none}.download-button[_ngcontent-%COMP%]{color:#00f;border:none;background:none}.download-button[_ngcontent-%COMP%]:hover, .delete-button1[_ngcontent-%COMP%]:hover{color:gray}.delete-button1[_ngcontent-%COMP%]{color:red;border:none;background:none}table[_ngcontent-%COMP%]{border-collapse:collapse;width:100%}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{text-align:left;padding:8px}tr[_ngcontent-%COMP%]:nth-child(even){background-color:#f2f2f2}ul[_ngcontent-%COMP%]{list-style-type:none;margin:0;padding:0}li[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:gray}select[_ngcontent-%COMP%]{font-size:20px}\"]\n  });\n  return AppComponent;\n})();\nexport { AppComponent };","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}